kind: pipeline
name: kernel-test

platform:
  os: linux
  arch: amd64

clone:
  depth: 1

steps:
  - name: kernel-test
    environment:
      GITID:
        from_secret: GITID
      GITPWD:
        from_secret: GITPWD
    image: ubuntu:20.04
    commands:
      - git clone https://$GITID:$GITPWD@github.com/$(cat /drone/src/repo) -b $(cat /drone/src/branch) --depth=1 kernel
      - cd kernel
      - ./drone-setup
      - ./drone-build
